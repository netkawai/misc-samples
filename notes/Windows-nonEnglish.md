WindowsのJapanese 言語対応の変遷

Windows1.0が作成されたのは、16bit時代。
この頃は扱えるリソースも少なく、Unicodeという概念が存在せず、
各国ごとに異なるエンコードを持っていた。
Windowsの登場とともに導入されたresリソースファイル(APIリソース)
という概念はダイアログボックスやUIのデザインや文字を各言語の
ローカルエンコードごとに保持するという単純な仕組み。
Windows NTが作成された際、APIにUnicode(WideChar)版が追加されたが、
以前のアプリケーションとの互換性のため、当然A(ASCII)版も残された。
このため、アプケーションはコンパイル時にどちらを使用するか決定する必要があり、
A版のAPIを使用するリソースファイルはローカルエンコードを使用する必要があり、
W版のAPIを使用するリソースファイルはUnicode(UCS2,BOM)を使用する必要がある。
リソースコンパイラは元のrcファイルを使用できるように、
コンパイル時にローカル→Unicode変換する形にした。
ただ、多くのアプリケーションはつい最近まで、一部は今でもA(ASCII)版を使用していたため、
OSのAdvancedの設定を変更しないと日本語表示できないものは多い。
もし、欧米アプリで日本語版がない場合でも、W版APIを使用していれば、
リソースファイルの日本語(CP932)をリソースコンパイラでUnicode
オプションをONにして、コンパイルするか、Unicode(BOM)形式のrcファイルを
用意してresファイルを作成すれば、日本語は表示できるようになった。
その後、.NETを導入し、Win32上にCLR(中間言語)と、CLR用の最初からUnicode化された
リソースファイルresx(.NETリソース)を導入することで、デフォルトでUnicode(BOM)ファイルが使用されるようになった。(C++プロジェクトは今でもローカルエンコードのファイルをデフォルトで使用する。)
ただし、resもresxも、各言語ごとにUIの部品位置や幅を調整する必要があり、言語ファイルを差し替えるだけでは、多言語対応ができなかった。過去とのソフトとの互換性上A版APIを廃止するわけにもいかず、かなり多くのソフト(Microsoftのソフトでさえ) A版を使い続けたため、アプケーションのUnicode化はなかなか進まない状況。
これは今でも同じ。
アーカイブソフト: 過去にローカルエンコードしたファイルが大量にあるため、
今からunicode化できない。新しいアーカイブで、最初からutf8を使用しているものはよいが、認知度が日本では低い場合が多い。
ZIP/TARでは、Unicode用のフラグを導入したが、古いソフトはそのフラグを知らないため、結局化ける。
メールソフト: 過去に既にローカルエンコードのメールが大量にあるため。
XML/HTML/Internetの本格的な普及とともに、Microsoft自体のグローバル化、ローカル化の
コストが重くなり、それを解消する表示技術としてWPF(XMLを画面デザイン言語として使用)を導入。
その後、Office2007でファイルフォーマットをOLEコンポーネントベースからXMLベース化する際に、新しいUIコンポーネントを開発。これがリボンインターフェイス(COMコンポーネント)。
これはWPFと同じコンセプトで、XMLを使用して、メニュー構造が記述できるようになり、
同様にでXMLを使用したダイアログデザイン表示を行うコンポーネントをリボンコンポーネント内の一部として導入した。
これにより、Office2007はWindowsアプケーションで初めて、Win32/COM APIレベルで、
APIリソースを使用しない(resリソースフリー)アプリケーションになり、XMLの言語ファイルを切り替えるだけで、ローカル化できるようになったことで、ローカル版開発期間を大幅に短縮できるようになった。